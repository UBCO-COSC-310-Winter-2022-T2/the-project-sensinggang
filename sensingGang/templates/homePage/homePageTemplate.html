<!-- the homePage template extends the masterTemplate, which includes the navbar-->
{% extends "../masterTemplate.html" %}

{% load static %}
{% block style %}
<link rel="stylesheet" href="{% static 'homePageTemplate.css' %}">
{% endblock style %}

{% block content %}

<div class="main">
    {% for subscription in results %}
    {% if subscription.sensorX %}
    <div class="item">
        Display sensor X chart
        <span> 1</span>
    </div> 
    {% endif %}
    {% if subscription.sensorY %} 
    <div class="item">
        Display sensor Y chart
        <span> 1</span>
    </div> 
    {% endif %}
    {% if subscription.sensorZ %}
    <div class="item">
        Display sensor Z chart
        <span> 1</span>
    </div> 
    {% endif %}
</div> 
{% endfor %}
<div class="item">
    
    <div class="col-md-4">
        <h4>Select Chart Type:</h4>
        <select id="chartType" class="form-select">
            <option value="line" selected>Line Chart</option>
            <option value="bar">Bar Chart</option>
            <option value="pie">Pie Chart</option>
            <option value="radar">Radar Chart</option>
            <option value="doughnut">Doughnut Chart</option>


        </select>
    </div>

    <div class="col-md-8">
        <canvas id="myChart" width="400" height="250"></canvas>
        <script>
            var ctx = document.getElementById('myChart').getContext('2d');
            var myChart;
            
            function createChart(type) {
                if(myChart) {
                    myChart.destroy();
                }
                myChart = new Chart(ctx, {
                    type: type,
                    data: {
                        labels: [{% for x in entries %}  '{{ x.topic }}',  {% endfor %}],
                        datasets: [{
                            label: '# of iot sensor products',
                            data: [{% for x in entries %}  {{ x.data }},  {% endfor %}],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.8)',
                                'rgba(54, 162, 235, 0.8)',
                                'rgba(255, 206, 86, 0.8)',
                                'rgba(75, 192, 192, 0.8)',
                                'rgba(153, 102, 255, 0.8)',
                                'rgba(255, 159, 64, 0.8)',
                                'rgba(240, 120, 50, 0.8)',
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(240, 120, 50, 1)',
    
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
            
            //default chart type
            createChart('line');
    
            //update upon user selection from drop down
            document.getElementById('chartType').addEventListener('change', function() {
                var type = this.value;
                createChart(type);
            });
        </script>
    </div>
    <h1>Data</h1>
<ul>
  {% for x in entries %}
    <li>{{ x.topic }} {{x.data }} {{ x.pub_date }}</li>
  {% endfor %}
</ul>
</div>
<div class="item">
    <span> 5</span>
</div>
<div class="item">
    <span> 6</span>
</div>
<div class="item">
    <span> 7</span>
</div>
<div class="item">
    <span> 8</span>
</div>
<div class="item">
    <span> 9</span>
</div>
<div class="item">
    <span> 10</span>
</div>
<div class="item">
    <span> 11</span>
</div>
<div class="item">
    <span> 12</span>
</div>
</div>  

  
{% endblock content %}